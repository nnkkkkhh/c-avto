import{c as w,u as q,r as g,j as e,S as D,C as k,X as C,t as h}from"./index-C7RinoSz.js";import{u as $}from"./useQuery-DsAPcWpp.js";import{P as F}from"./plus-DYFc_zNV.js";import{U as I}from"./user-D4hTlbyF.js";import{C as _}from"./clock-0scXgq7n.js";import{f as j,p as N,r as v}from"./ru-B3KvSnPF.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],P=w("circle-check-big",T);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],U=w("circle-x",Q);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],E=w("funnel",B),O={scheduled:{label:"Запланировано",bg:"bg-blue-50",text:"text-blue-700",dot:"bg-blue-500"},completed:{label:"Завершено",bg:"bg-emerald-50",text:"text-emerald-700",dot:"bg-emerald-500"},cancelled:{label:"Отменено",bg:"bg-red-50",text:"text-red-700",dot:"bg-red-500"},"no-show":{label:"Не пришёл",bg:"bg-gray-100",text:"text-gray-600",dot:"bg-gray-400"}};function X({status:l}){const c=O[l];return e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs ${c.bg} ${c.text}`,style:{fontWeight:500},children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${c.dot}`}),c.label]})}function G({appointment:l,patients:c,onClose:m,onSave:x}){const[r,a]=g.useState({patientId:(l==null?void 0:l.patientId)||"",patientName:(l==null?void 0:l.patientName)||"",doctorId:(l==null?void 0:l.doctorId)||"1",doctorName:(l==null?void 0:l.doctorName)||"Доктор Иванов А.П.",date:(l==null?void 0:l.date)||"",time:(l==null?void 0:l.time)||"",service:(l==null?void 0:l.service)||"",status:(l==null?void 0:l.status)||"scheduled",notes:(l==null?void 0:l.notes)||""}),b=[{id:"1",name:"Доктор Иванов А.П."},{id:"2",name:"Доктор Смирнова Е.В."},{id:"3",name:"Доктор Козлов М.С."}],n=["Консультация","Лечение кариеса","Профессиональная чистка","Отбеливание зубов","Удаление зуба","Установка брекетов","Протезирование","Рентген","Пломбирование"],y=t=>{const o=c.find(u=>u.id===t);a({...r,patientId:t,patientName:(o==null?void 0:o.fullName)||""})},d=t=>{const o=b.find(u=>u.id===t);a({...r,doctorId:t,doctorName:(o==null?void 0:o.name)||""})},i=t=>{t.preventDefault(),x(r)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-5 border-b border-gray-100",children:[e.jsx("h2",{className:"text-gray-900",style:{fontSize:"1.1rem",fontWeight:600},children:l?"Редактировать запись":"Новая запись"}),e.jsx("button",{onClick:m,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(C,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("form",{onSubmit:i,className:"p-6 space-y-4 max-h-[75vh] overflow-y-auto",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1.5",style:{fontWeight:500},children:"Пациент *"}),e.jsxs("select",{value:r.patientId,onChange:t=>y(t.target.value),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50 text-sm",required:!0,children:[e.jsx("option",{value:"",children:"Выберите пациента"}),c.map(t=>e.jsx("option",{value:t.id,children:t.fullName},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1.5",style:{fontWeight:500},children:"Врач *"}),e.jsx("select",{value:r.doctorId,onChange:t=>d(t.target.value),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50 text-sm",children:b.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1.5",style:{fontWeight:500},children:"Дата *"}),e.jsx("input",{type:"date",value:r.date,onChange:t=>a({...r,date:t.target.value}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50 text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1.5",style:{fontWeight:500},children:"Время *"}),e.jsx("input",{type:"time",value:r.time,onChange:t=>a({...r,time:t.target.value}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50 text-sm",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1.5",style:{fontWeight:500},children:"Услуга *"}),e.jsxs("select",{value:r.service,onChange:t=>a({...r,service:t.target.value}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50 text-sm",required:!0,children:[e.jsx("option",{value:"",children:"Выберите услугу"}),n.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1.5",style:{fontWeight:500},children:"Статус"}),e.jsxs("select",{value:r.status,onChange:t=>a({...r,status:t.target.value}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50 text-sm",children:[e.jsx("option",{value:"scheduled",children:"Запланировано"}),e.jsx("option",{value:"completed",children:"Завершено"}),e.jsx("option",{value:"cancelled",children:"Отменено"}),e.jsx("option",{value:"no-show",children:"Не пришёл"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1.5",style:{fontWeight:500},children:"Заметки"}),e.jsx("textarea",{value:r.notes,onChange:t=>a({...r,notes:t.target.value}),rows:2,className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50 text-sm resize-none",placeholder:"Дополнительная информация..."})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:m,className:"flex-1 py-2.5 border border-gray-200 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors text-sm",style:{fontWeight:500},children:"Отмена"}),e.jsx("button",{type:"submit",className:"flex-1 py-2.5 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors text-sm shadow-lg shadow-blue-200",style:{fontWeight:500},children:l?"Сохранить":"Создать"})]})]})]})})}function Z(){const{appointments:l,patients:c,addAppointment:m,updateAppointment:x,deleteAppointment:r}=q(),[a,b]=g.useState(""),[n,y]=g.useState("all"),[d,i]=g.useState(null),[t,o]=g.useState("list"),{isLoading:u}=$({queryKey:["appointments"],queryFn:async()=>(await new Promise(s=>setTimeout(s,300)),l),initialData:l}),p=l.filter(s=>{const f=s.patientName.toLowerCase().includes(a.toLowerCase())||s.service.toLowerCase().includes(a.toLowerCase())||s.doctorName.toLowerCase().includes(a.toLowerCase()),z=n==="all"||s.status===n;return f&&z}).sort((s,f)=>new Date(s.date).getTime()-new Date(f.date).getTime()),S=s=>{d==="new"?(m(s),h.success("Запись создана")):d&&(x(d.id,s),h.success("Запись обновлена")),i(null)},W=s=>{x(s,{status:"completed"}),h.success("Запись отмечена как завершённая")},M=s=>{x(s,{status:"cancelled"}),h.info("Запись отменена")},A=s=>{confirm("Удалить эту запись?")&&(r(s),h.success("Запись удалена"))},L={all:l.length,scheduled:l.filter(s=>s.status==="scheduled").length,completed:l.filter(s=>s.status==="completed").length,cancelled:l.filter(s=>s.status==="cancelled").length};return u&&l.length===0?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-10 h-10 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6 max-w-[1400px]",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-gray-900",style:{fontSize:"1.75rem",fontWeight:700},children:"Записи на приём"}),e.jsx("p",{className:"text-gray-500 text-sm mt-0.5",children:"Управление расписанием приёмов"})]}),e.jsxs("button",{onClick:()=>i("new"),className:"flex items-center gap-2 px-5 py-2.5 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors text-sm shadow-lg shadow-blue-200",style:{fontWeight:500},children:[e.jsx(F,{className:"w-4 h-4"}),"Создать запись"]})]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:[{key:"all",label:"Все"},{key:"scheduled",label:"Запланировано"},{key:"completed",label:"Завершено"},{key:"cancelled",label:"Отменено"}].map(s=>e.jsxs("button",{onClick:()=>y(s.key),className:`flex items-center gap-2 px-4 py-2 rounded-xl text-sm transition-colors ${n===s.key?"bg-blue-600 text-white shadow-lg shadow-blue-200":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-200"}`,style:{fontWeight:500},children:[s.label,e.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${n===s.key?"bg-white/20 text-white":"bg-gray-100 text-gray-600"}`,children:L[s.key]})]},s.key))}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-4",children:e.jsx("div",{className:"flex gap-3",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(D,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",value:a,onChange:s=>b(s.target.value),placeholder:"Поиск по пациенту, услуге, врачу...",className:"w-full pl-10 pr-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50 text-sm"})]})})}),e.jsxs("div",{className:"space-y-3",children:[p.length===0&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 text-center py-16",children:[e.jsx(k,{className:"w-12 h-12 text-gray-200 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:a?`Ничего не найдено по запросу «${a}»`:"Нет записей"})]}),p.map(s=>e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-5 hover:shadow-md transition-all",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[e.jsxs("div",{className:"flex-shrink-0 w-20 text-center p-3 bg-blue-50 rounded-xl",children:[e.jsx("p",{className:"text-blue-600 text-sm",style:{fontWeight:700},children:j(N(s.date),"d",{locale:v})}),e.jsx("p",{className:"text-blue-400 text-xs",children:j(N(s.date),"MMM",{locale:v})}),e.jsx("p",{className:"text-blue-700 text-xs mt-1",style:{fontWeight:600},children:s.time})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-gray-900",style:{fontSize:"0.95rem",fontWeight:600},children:s.patientName}),e.jsx(X,{status:s.status})]}),e.jsx("p",{className:"text-gray-500 text-sm",children:s.service})]})}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-3 text-gray-400 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(I,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:s.doctorName})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(_,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:s.time})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(k,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:j(N(s.date),"d MMMM yyyy",{locale:v})})]})]}),s.notes&&e.jsx("p",{className:"text-gray-400 text-xs mt-2 bg-gray-50 px-3 py-2 rounded-lg",children:s.notes})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[s.status==="scheduled"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>W(s.id),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs bg-emerald-50 text-emerald-700 rounded-lg hover:bg-emerald-100 transition-colors",style:{fontWeight:500},children:[e.jsx(P,{className:"w-3.5 h-3.5"}),"Завершить"]}),e.jsxs("button",{onClick:()=>M(s.id),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs bg-gray-50 text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",style:{fontWeight:500},children:[e.jsx(U,{className:"w-3.5 h-3.5"}),"Отменить"]}),e.jsx("button",{onClick:()=>i(s),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:e.jsx(E,{className:"w-4 h-4"})})]}),e.jsx("button",{onClick:()=>A(s.id),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(C,{className:"w-4 h-4"})})]})]})},s.id))]}),d!==null&&e.jsx(G,{appointment:d==="new"?null:d,patients:c,onClose:()=>i(null),onSave:S})]})}export{Z as default};
